#!/bin/sh

# required version of autotools
am_require="1.9.3"
ac_require="2.59"
lt_require="1.5.10"

# location of config.h.in
config_h_in="config/config.h.in"

have_autotools=yes

am_version=`automake --version 2>&1 | head -1 | cut -d ' ' -f 4`
ac_version=`autoconf --version 2>&1 | head -1 | cut -d ' ' -f 4`
lt_version=`libtoolize --version 2>&1 | head -1 | cut -d ' ' -f 4`

if test "x$am_version" != "x$am_require"; then
  echo "Error: Required automake version $am_require, but found $am_version."
  have_autotools=no
fi
if test "x$ac_version" != "x$ac_require"; then
  echo "Error: Required autoconf version $ac_require, but found $ac_version."
  have_autotools=no
fi
if test "x$lt_version" != "x$lt_require"; then
  echo "Error: Required libtool version $lt_require, but found $lt_version."
  have_autotools=no
fi

if test "$have_autotools" = no; then
  echo "Stop."
  exit -1
fi

set -x
aclocal -I config
libtoolize --force --copy
test -f "$config_h_in" && touch "$config_h_in"
automake --foreign --add-missing --copy
autoconf
rm -rf autom4te.cache
