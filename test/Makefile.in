#############################################################################
#
# alps/looper: multi-cluster quantum Monte Carlo algorithm for spin systems
#              in path-integral and SSE representations
# 
# Copyright (C) 1997-2003 by Synge Todo <wistaria@comp-phys.org>,
# 
# Permission is hereby granted, free of charge, to any person or organization 
# obtaining a copy of the software covered by this license (the "Software") 
# to use, reproduce, display, distribute, execute, and transmit the Software, 
# and to prepare derivative works of the Software, and to permit others
# to do so for non-commerical academic use, all subject to the following:
# 
# The copyright notice in the Software and this entire statement, including 
# the above license grant, this restriction and the following disclaimer, 
# must be included in all copies of the Software, in whole or in part, and 
# all derivative works of the Software, unless such copies or derivative 
# works are solely in the form of machine-executable object code generated by 
# a source language processor.
# 
# In any scientific publication based in part or wholly on the Software, the
# use of the Software has to be acknowledged and the publications quoted
# on the web page http://www.alps.org/license/ have to be referenced.
# 
# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR 
# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, 
# FITNESS FOR A PARTICULAR PURPOSE, TITLE AND NON-INFRINGEMENT. IN NO EVENT 
# SHALL THE COPYRIGHT HOLDERS OR ANYONE DISTRIBUTING THE SOFTWARE BE LIABLE 
# FOR ANY DAMAGES OR OTHER LIABILITY, WHETHER IN CONTRACT, TORT OR OTHERWISE, 
# ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER 
# DEALINGS IN THE SOFTWARE.
#
#############################################################################

srcdir = @srcdir@
top_srcdir = @top_srcdir@
builddir = @builddir@l
top_builddir = ./@top_builddir@

include @INCLUDE_MK@

cppflags = $(CPPFLAGS) -I$(top_srcdir)
cppflags_mpi = $(CPPFLAGS_MPI) -I$(top_srcdir)
cxxflags = $(CXXFLAGS)
ldflags = $(LDFLAGS)
ldflags_mpi = $(LDFLAGS_MPI)
libs_program = -lalps -lcomm-sgl $(HDF5_LIBS) $(XML_LIBS) $(BASE_LIBS)
libs_program_mpi = -lalps -lcomm-mpi $(HDF5_LIBS) $(XML_LIBS) $(MPI_LIBS) $(BASE_LIBS)

LOCAL_CONFIG = lattices.xml models.xml amida.xdr
TESTOK = amida.ok fill_duration.ok index_helper.ok permutation.ok simplegraph.ok unionfind.ok xxz_matrix.ok xxz_model.ok virtualgraph.ok weight.ok 

include $(RULES_MK)
include $(srcdir)/Makefile.dep

# dependency for tests

amida.ok : $(srcdir)/amida.output
fill_duration.ok : $(srcdir)/fill_duration.input $(srcdir)/fill_duration.output
simplegraph.ok : $(srcdir)/simplegraph.input $(srcdir)/simplegraph.output
xxz_model.ok : $(srcdir)/xxz_model.input $(srcdir)/xxz_model.output models.xml lattices.xml
xxz_matrix.ok : $(srcdir)/xxz_matrix.input $(srcdir)/xxz_matrix.output

# dependency for inputs

models.xml : $(srcdir)/models.xml.in
	$(top_builddir)config.status models.xml
lattices.xml : $(srcdir)/lattices.xml.in
	$(top_builddir)config.status lattices.xml
